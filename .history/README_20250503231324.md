# ğŸ›ï¸ Odento-SHOP

Bienvenue dans **Odento-SHOP**, un site e-commerce de dÃ©monstration dÃ©veloppÃ© avec **Symfony 6.4**, **EasyAdmin**, **Doctrine**, **Bootstrap** et **MySQL**.  
Le projet a Ã©tÃ© crÃ©Ã© dans le cadre dâ€™un apprentissage guidÃ© avec accompagnement pÃ©dagogique.

---

## ğŸ”§ Technologies principales

- Symfony 6.4 (LTS)
- PHP 8.2
- EasyAdmin
- Doctrine ORM
- Bootstrap 5
- MySQL (via XAMPP)
- Git / GitHub

---

## ğŸ“Š FonctionnalitÃ©s rÃ©alisÃ©es

âœ… Gestion des produits (Articles)  
âœ… Gestion des catÃ©gories (avec relation ManyToOne â†’ Article)  
âœ… Gestion des posts (blog)  
âœ… **Upload dâ€™images dans les posts via EasyAdmin**  
âœ… **Refonte visuelle des formulaires Login et Register avec Bootstrap 5 via YAML**  
âœ… Gestion des utilisateurs avec sÃ©curitÃ© (User + authentification)  
âœ… Dashboard complet avec EasyAdmin  
âœ… Migrations Doctrine  
âœ… Architecture MVC claire

---

## ğŸ–¼ï¸ Upload dâ€™image dans les Posts

- Champ `image` ajoutÃ© dans lâ€™entitÃ© `Post`
- Dashboard EasyAdmin avec **champ image upload automatique**
- Stockage dans `public/images/`
- Nom du fichier gÃ©rÃ© automatiquement
- Image visible dans lâ€™administration

---

## ğŸ¨ Refonte des formulaires Login & Register

- Les formulaires `login.html.twig` et `register.html.twig` utilisent dÃ©sormais une structure **Bootstrap 5 complÃ¨te**
- Utilisation de `container`, `card`, `form-control`, `row`, `col`, etc.
- IntÃ©gration cohÃ©rente avec le thÃ¨me du site
- **Meilleure expÃ©rience utilisateur** (visuelle + responsive)

---

## ğŸ› ï¸ Installation du projet

### 1. Cloner le dÃ©pÃ´t Git

```bash
git clone https://github.com/rigal34/odento.git
cd odento
```

### 2. Installer les dÃ©pendances PHP

```bash
composer install
```

### 3. Configuration de la base de donnÃ©es

Dans le fichier `.env` :

```env
DATABASE_URL="mysql://root:@127.0.0.1:3306/odento"
```

CrÃ©er la base et les tables :

```bash
php bin/console doctrine:database:create
php bin/console doctrine:migrations:migrate
```

### 4. Lancer le serveur Symfony

```bash
symfony serve -d
```

Ou avec PHP directement :

```bash
php -S localhost:8000 -t public
```

### 5. AccÃ©der Ã  lâ€™administration

- http://localhost:8000/admin  
- Connectez-vous avec un utilisateur existant ou crÃ©ez-en un

---

## ğŸ“‚ Structure du projet (Mise Ã  jour)

```plaintext
odento/
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ libs/          # Librairies JS/CSS ajoutÃ©es manuellement
â”‚   â”‚   â””â”€â”€ drift-zoom/  # Fichiers pour Drift Zoom (JS, CSS, Map)
â”‚   â”œâ”€â”€ styles/
â”‚   â”‚   â””â”€â”€ app.css      # Fichier CSS principal (importe drift-basic.min.css)
â”‚   â””â”€â”€ app.js         # Fichier JS principal (importe/initialise Drift.min.js)
â”œâ”€â”€ bin/
â”‚   â””â”€â”€ console
â”œâ”€â”€ config/
â”œâ”€â”€ migrations/
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ assets/        # Assets copiÃ©s du thÃ¨me (ex: favicons)
â”‚   â”‚   â””â”€â”€ img/
â”‚   â”‚       â”œâ”€â”€ favicon.png
â”‚   â”‚       â””â”€â”€ apple-touch-icon.png
â”‚   â”œâ”€â”€ images/        # Emplacement probable pour les images produits uploadÃ©es
â”‚   â”œâ”€â”€ bundles/       # Assets des bundles Symfony installÃ©s
â”‚   â””â”€â”€ index.php      # Point d'entrÃ©e Symfony
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ Controller/
â”‚   â”‚   â”œâ”€â”€ Admin/
â”‚   â”‚   â””â”€â”€ CategorieController.php # RenommÃ© ou contient catÃ©gorie/produit
â”‚   â”œâ”€â”€ Entity/
â”‚   â”‚   â”œâ”€â”€ Article.php
â”‚   â”‚   â””â”€â”€ Category.php
â”‚   â”œâ”€â”€ Form/
â”‚   â”œâ”€â”€ Repository/    # Contient ArticleRepository, CategoryRepository
â”‚   â””â”€â”€ Security/
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ base.html.twig # Template de base (contient liens favicon corrigÃ©s)
â”‚   â”œâ”€â”€ home/          # Templates pour le front-office
â”‚   â”‚   â”œâ”€â”€ categorie.html.twig # (contient image produit avec asset())
â”‚   â”‚   â””â”€â”€ detail_produit.html.twig # (contient image produit/zoom avec asset())
â”‚   â””â”€â”€ ...            # Autres templates (post, dashboard, etc.)
â”œâ”€â”€ translations/
â”œâ”€â”€ var/
â”œâ”€â”€ .env
â”œâ”€â”€ composer.json
â””â”€â”€ README.md
```

---

## ğŸ’¼ Notes personnelles

Projet conÃ§u Ã  des fins pÃ©dagogiques avec aide dâ€™un professeur.  
Toutes les entitÃ©s, relations, migrations, et la configuration EasyAdmin ont Ã©tÃ© construites progressivement.  
Les formulaires front ont Ã©tÃ© retravaillÃ©s Ã  la main avec Bootstrap pour un meilleur rendu utilisateur.

---

## ğŸ”— Liens utiles

- [Documentation Symfony](https://symfony.com/doc/current/index.html)
- [Documentation EasyAdmin](https://symfony.com/bundles/EasyAdminBundle/current/)
---

## ğŸ—‚ï¸ Mise en page front-end - Page catÃ©gorie Twig

La page `categorie.html.twig` a Ã©tÃ© construite Ã  partir dâ€™un template Bootstrap avancÃ©. Elle comprend :

- Un **systÃ¨me de filtres latÃ©raux** : par catÃ©gories, prix, marques, couleurs
- Un **systÃ¨me dâ€™affichage produit** (grid/list) avec images, prix, rating, boutons dâ€™action
- Une section de pagination
- Une compatibilitÃ© responsive intÃ©grÃ©e
- Une intÃ©gration Twig progressive pour relier dynamiquement les donnÃ©es back-end

ğŸ¯ Objectif de cette page :  
Afficher **les articles liÃ©s Ã  une catÃ©gorie**, rÃ©cupÃ©rÃ©s dynamiquement depuis la base de donnÃ©es Symfony, tout en conservant le design du template.

ğŸ› ï¸ Prochaine Ã©tape : insÃ©rer la boucle `{% for article in articles %}` dans la section "product-box" pour afficher chaque article dynamique avec son image, titre et prix.

---
ğŸ§­ Affichage dynamique des catÃ©gories et sous-catÃ©gories
Une nouvelle fonctionnalitÃ© a Ã©tÃ© ajoutÃ©e sur le front pour afficher les catÃ©gories principales et leurs sous-catÃ©gories de maniÃ¨re automatisÃ©e via Twig et Doctrine.

âœ… FonctionnalitÃ©s ajoutÃ©es
Boucle {% for category in categories %} sur la page categorie.html.twig

Affichage dynamique de chaque catÃ©gorie rÃ©cupÃ©rÃ©e depuis la base de donnÃ©es

GÃ©nÃ©ration automatique des sous-catÃ©gories via une relation OneToMany auto-rÃ©fÃ©rencÃ©e

Utilisation de {{ category.id }} pour gÃ©rer les collapse Bootstrap (affichage/masquage)

Les sous-catÃ©gories sont affichÃ©es via la boucle :

twig
Copier
Modifier
{% for Subcategory in category.categories %}
  {{ Subcategory.name }}
{% endfor %}
ğŸ“¦ Exemple HTML rendu (extrait) :
html
Copier
Modifier
<li class="category-item">
  <div class="category-header" data-bs-toggle="collapse" data-bs-target="#subcat-1">
    <a href="javascript:void(0)" class="category-link">VÃªtements</a>
  </div>
  <ul id="subcat-1" class="subcategory-list collapse">
    <li class="subcategory-item"><a href="#">Hommes</a></li>
    <li class="subcategory-item"><a href="#">Femmes</a></li>
  </ul>
</li>
ğŸ› ï¸ Code utilisÃ© dans categorie.html.twig :
twig
Copier
Modifier
<ul class="category-tree list-unstyled mb-0">
  {% for category in categories %}
    <li class="category-item">
      <div class="category-header collapsed"
           data-bs-toggle="collapse"
           data-bs-target="#categories-1-clothing-subcategories-{{ category.id }}"
           aria-expanded="false"
           aria-controls="categories-1-clothing-subcategories-{{ category.id }}">
        <a href="javascript:void(0)" class="category-link">{{ category.name }}</a>
      </div>

      <ul id="categories-1-clothing-subcategories-{{ category.id }}" class="subcategory-list collapse">
        {% for Subcategory in category.categories %}
          <li><a href="javascript:void(0)" class="subcategory-link">{{ Subcategory.name }}</a></li>
        {% endfor %}
      </ul>
    </li>
  {% endfor %}
</ul>
ğŸ”„ Objectif de cette fonctionnalitÃ© :
Permettre au client ou Ã  lâ€™administrateur de modifier les catÃ©gories ou sous-catÃ©gories depuis le dashboard EasyAdmin,
et de voir ces changements automatiquement reflÃ©tÃ©s sur le site, sans modifier le code HTML.
---

## âœ¨ AmÃ©liorations et Corrections RÃ©centes (Session du 2 Mai - Montpellier)

Cette section documente les ajustements et intÃ©grations rÃ©alisÃ©s lors de notre session de travail et de mentorat.

### 1. Correction Affichage Images Articles

* **ProblÃ¨me IdentifiÃ© :** Les images des articles (liÃ©es via `article.image`) ne s'affichaient pas de maniÃ¨re cohÃ©rente. Elles apparaissaient sur la page catÃ©gorie (`/categorie?id=X`) mais pas sur la page dÃ©tail produit (`/produit/X`).
* **Cause :** Utilisation d'un chemin relatif (`src="images/{{ article.image }}"`) dans les templates Twig. Le navigateur interprÃ©tait ce chemin diffÃ©remment en fonction de l'URL de la page courante, Ã©chouant sur les pages avec une structure d'URL plus "profonde" (comme `/produit/X`).
* **Solution ImplÃ©mentÃ©e :** Remplacement systÃ©matique des chemins relatifs par la fonction Twig `asset()` pour gÃ©nÃ©rer des URLs publiques fiables depuis la racine web (`public/`). Le code utilise maintenant `src="{{ asset('images/' ~ article.image) }}"` (en supposant que les images sont dans `public/images/`) dans `detail_produit.html.twig` et `categorie.html.twig`.

### 2. IntÃ©gration et Correction Effet Zoom Image (Drift Zoom)

* **Contexte :** Le template HTML (copiÃ© d'un thÃ¨me externe) utilisait une classe `drift-zoom` pour un effet de loupe au survol de l'image produit principale, mais cet effet ne fonctionnait pas correctement (l'image disparaissait au survol).
* **IntÃ©gration de la Librairie :**
    * Identification de la librairie JavaScript `Drift Zoom`.
    * Copie des fichiers nÃ©cessaires (`Drift.min.js`, `drift-basic.min.css`, `Drift.min.js.map`) depuis le thÃ¨me original vers le dossier `assets/libs/drift-zoom/` du projet.
    * Import du fichier CSS `drift-basic.min.css` dans `assets/styles/app.css` via `@import`.
    * Import du fichier JavaScript `Drift.min.js` dans `assets/app.js` via `import`.
    * Ajout du **code d'initialisation JavaScript** nÃ©cessaire (ex: `new Drift(...)`) dans `assets/app.js` pour activer la librairie sur les Ã©lÃ©ments concernÃ©s.
* **Correction de la Source du Zoom :**
    * Identification que l'attribut `data-zoom` sur la balise `<img>` pointait vers un chemin d'image invalide (`assets/...`).
    * Correction de l'attribut pour utiliser Ã©galement la fonction `asset()` et pointer vers une URL d'image valide : `data-zoom="{{ asset('images/' ~ article.image) }}"`.
* **RÃ©sultat :** L'effet de zoom au survol est maintenant fonctionnel sur la page dÃ©tail produit.

### 3. Clarifications Conceptuelles (Apprentissage)

* Revue et approfondissement de concepts Symfony clÃ©s : cycle requÃªte/rÃ©ponse, objet `Request` vs requÃªte brute HTTP, rÃ´le des Services, des Repositories et du ModÃ¨le (MVC), Injection de DÃ©pendances et Conteneur de Services, fonctionnement de la fonction `asset()` vs dossier `assets/`, filtres Twig (`default`), opÃ©rateurs Twig (`~`).
* Discussion sur les bonnes pratiques Git (commit avant modification, branches).
* Analyse des outils de dÃ©veloppement du navigateur (onglet RÃ©seau, Inspecteur d'Ã©lÃ©ments).
* Distinction entre classes Bootstrap natives et classes CSS/JS personnalisÃ©es issues de thÃ¨mes.
* Fonctionnement du systÃ¨me d'assets de Symfony (AssetMapper) et des imports JS/CSS.

---
### 1. Correction Affichage Images & Favicons (Utilisation de `asset()`)

* **ProblÃ¨me IdentifiÃ© :** Les images des articles et les favicons ne s'affichaient pas de maniÃ¨re cohÃ©rente sur toutes les pages (ex: OK sur `/categorie?id=X`, mais KO sur `/produit/X`).
* **Cause :** Utilisation de chemins relatifs (ex: `src="images/..."`, `href="assets/img/..."`) dans les templates Twig. Le navigateur interprÃ©tait ces chemins diffÃ©remment en fonction de l'URL de la page courante.
* **Solution ImplÃ©mentÃ©e :** Remplacement systÃ©matique par la fonction Twig `asset()` pour gÃ©nÃ©rer des URLs publiques fiables depuis la racine web (`public/`).
    * Pour les images articles (supposÃ©es dans `public/images/`) : `src="{{ asset('images/' ~ article.image) }}"`.
    * Pour les favicons (situÃ©s dans `public/assets/img/`) : `href="{{ asset('assets/img/favicon.png') }}"`.
    * Cette correction a Ã©tÃ© appliquÃ©e dans `detail_produit.html.twig`, `categorie.html.twig` et `base.html.twig`.

### 2. IntÃ©gration et Correction Effet Zoom Image (Drift Zoom)

* **Contexte :** Le template HTML (copiÃ© d'un thÃ¨me externe) utilisait une classe `drift-zoom` pour un effet de loupe au survol, mais l'effet Ã©chouait (image disparaissait).
* **IntÃ©gration de la Librairie :**
    * Copie des fichiers `Drift.min.js` et `drift-basic.min.css` (et `.map`) depuis le thÃ¨me original vers le dossier `assets/libs/drift-zoom/` du projet.
    * Import du CSS via `@import` dans `assets/styles/app.css`.
    * Import du JS via `import` dans `assets/app.js` (gÃ©rÃ© par AssetMapper).
    * Ajout du code d'initialisation JavaScript nÃ©cessaire (`new Drift(...)` ou similaire) dans `assets/app.js`.
* **Correction de la Source du Zoom (`data-zoom`) :**
    * Identification que l'attribut `data-zoom` sur la balise `<img>` pointait vers un chemin d'image invalide.
    * Correction de l'attribut pour utiliser `asset()` et pointer vers l'URL de l'image principale : `data-zoom="{{ asset('images/' ~ article.image) }}"` (en supposant images produits dans `public/images/`).
* **RÃ©sultat :** L'effet de zoom au survol est fonctionnel.

### 3. Clarifications Conceptuelles (Apprentissage)

* Revue et approfondissement de concepts Symfony/Twig/HTTP/Git : cycle requÃªte/rÃ©ponse, objet `Request` vs requÃªte brute HTTP, rÃ´le des Services, des Repositories et du ModÃ¨le (MVC), **distinction claire entre Injection de DÃ©pendances pour les Services (ex: `PostRepository` dans `actu()`) et ParamConverter pour les EntitÃ©s liÃ©es Ã  un paramÃ¨tre de route (ex: `Post` dans `detail()`**) , fonctionnement de la fonction `asset()` vs dossier `assets/`, filtres Twig (`default`), opÃ©rateurs Twig (`~`).
* Discussion sur les bonnes pratiques Git (commit avant modification, branches).
* Analyse des outils de dÃ©veloppement du navigateur (onglet RÃ©seau, Inspecteur d'Ã©lÃ©ments).
* Distinction entre classes Bootstrap natives et classes CSS/JS personnalisÃ©es issues de thÃ¨mes.
* Fonctionnement du systÃ¨me d'assets de Symfony (AssetMapper) et des imports JS/CSS.

### 4. Mise en Place Structure Blog/ActualitÃ©s (Pattern Liste -> DÃ©tail)

* **Contexte :** Initialisation de la section "ActualitÃ©s" du site (basÃ©e sur l'entitÃ© `Post`).
* **Structure ImplÃ©mentÃ©e (par le mentor, Ã  complÃ©ter/styliser par l'apprenti) :**
    * **Route Liste (`/actualites`) :** GÃ©rÃ©e par `PostController::actu(PostRepository $postRepository)`. Utilise l'**Injection de DÃ©pendances (DI)** standard pour obtenir le `PostRepository` afin de rÃ©cupÃ©rer la liste des posts. Rend le template `postindex.html.twig` en passant la liste (`posts`).
    * **Route DÃ©tail (`/actualites/{id}`) :** GÃ©rÃ©e par `PostController::detail(Post $post)`. Utilise le **ParamConverter** pour obtenir directement l'entitÃ© `Post` correspondant Ã  l'`id` de l'URL et la passe au template `detail.html.twig`. La gestion du 404 (si l'ID n'existe pas) est automatique.
    * **Templates Twig :** `postindex.html.twig` (liste avec boucle `for` et lien `path('app_actu_detail', {id: post.id})`) et `detail.html.twig` (dÃ©tail recevant la variable `post`).
* **Objectif PÃ©dagogique :** Pratiquer et comprendre le pattern Liste->DÃ©tail, le routage avec paramÃ¨tres, et la diffÃ©rence entre l'injection d'un service (Repository via DI) et l'injection d'une entitÃ© via l'URL (ParamConverter).
---